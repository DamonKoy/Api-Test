*** Settings ***
Default Tags
Resource          ../Config/config.txt

*** variable ***


*** Test Cases ***
测试服获取install_token
    [Tags]    smoke
    测试服获取install_token    &{user_id}[user2]

smoke
    [Tags]    smoke
    ${page}    set variable    1
    ${pagesize}    set variable     30
    ${response}=    获取漫画连载列表    ${page}    ${pagesize}
    校验接口返回状态正常    ${response}

校验返回值list数组的必要字段
    ${page}    set variable    1
    ${pagesize}    set variable     30
    ${response}=    获取漫画连载列表    ${page}    ${pagesize}
    校验接口返回状态正常    ${response}
    @{dataList}    Set Variable    ${response.json()['data']['list']}
    : FOR    ${data}    IN    @{dataList}
    \    Log    ${data}
    \    ${group_id}    Get From Dictionary    ${data}    group_id
    \    ${title}    Get From Dictionary    ${data}    title
    \    ${is_purchase}    Get From Dictionary    ${data}    is_purchase
    \    ${count}    Get From Dictionary    ${data}    count
    \    ${flag}    Run Keyword If    '${group_id}'!='' and '${title}'!='' and '${is_purchase}'!='' and '${count}'!=''   Set Variable    true
    \    Run Keyword If    '${flag}'=='${None}'    Exit for loop
    Should Be Equal As Strings    ${flag}    true

校验返回值list数组的可空字段
    ${page}    set variable    1
    ${pagesize}    set variable     30
    ${response}=    获取漫画连载列表    ${page}    ${pagesize}
    校验接口返回状态正常    ${response}
    ${length} =    Get Length    ${response.json()['data']['list']}
    : FOR    ${i}    IN Range   ${length}
    \    Log    ${response.json()['data']['list'][${i}]}
    \    Should Contain    ${response.json()['data']['list'][${i}]}    title_image

#校验page的翻页功能
#    ${page}    set variable    2
#    ${pagesize}    set variable     30
#    ${response}=    获取漫画单篇列表    ${page}    ${pagesize}
#    校验接口返回状态正常    ${response}


校验pagesize的作用
    ${page}    set variable    1
    ${pagesize}    set variable     1
    ${response}=    获取漫画连载列表    ${page}    ${pagesize}
    校验接口返回状态正常    ${response}
    ${length} =    Get Length    ${response.json()['data']['list']}
    Should Be Equal As Integers    ${length}    1

校验pagesize>1的返回效果
    ${page}    set variable    1
    ${pagesize}    set variable     10
    ${response}=    获取漫画连载列表    ${page}    ${pagesize}
    校验接口返回状态正常    ${response}
    ${length} =    Get Length    ${response.json()['data']['list']}
    Should Be true    ${length} >= 0