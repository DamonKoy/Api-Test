*** Settings ***
Default Tags
Resource          ../Config/config.txt

*** variable ***


*** Test Cases ***
测试服获取install_token
    [Tags]    smoke
    测试服获取install_token    &{user_id}[user2]

smoke
    [Tags]    smoke
    ${keyword}    set variable    服装
    ${response}=    获取搜索联想词    ${keyword}
    校验接口返回状态正常    ${response}

校验返回的user_id
    ${keyword}    set variable    服
    ${response}=    获取搜索联想词    ${keyword}
    校验接口返回状态正常    ${response}
    @{dataList}    Set Variable    ${response.json()['data']}
    : FOR    ${data}    IN    @{dataList}
    \    Log    ${data}
    \    ${taskType}    Get From Dictionary    ${data}    type
    \    ${planStartTime}    Get From Dictionary    ${data}    taskPlanTime
    \    ${flag}    Run Keyword If    '${taskType}'=='&{taskCode}[仔猪断奶]' and '${planStartTime}'=='${expectedPlanStartTimeStamp}'    Set Variable    true
    \    Run Keyword If    '${flag}'!='${None}'    Exit for loop
    Should Be Equal As Strings    ${flag}    true

校验数据库的user_id
    ${response}=    手机号码登录    &{user}[user2]    &{password}[password1]
    log    ${response.content}
    #开始断言接口返回响应
    Should Be Equal As Strings    ${response.status_code}    200
    #开始断言返回结果
    log    ${response.json()['message']['message']}
    Should Be Equal As Strings    ${response.json()['status']}    ok
    Should Be Equal As Strings    ${response.json()['message']['message']}    操作成功
    Should Be Equal As Strings    ${response.json()['data']['profile']['user_id']}    &{user_id}[user2]

校验返回的nickname
    ${response}=    手机号码登录    &{user}[user2]    &{password}[password1]
    log    ${response.content}
    #开始断言接口返回响应
    Should Be Equal As Strings    ${response.status_code}    200
    #开始断言返回结果
    log    ${response.json()['message']['message']}
    Should Be Equal As Strings    ${response.json()['status']}    ok
    Should Be Equal As Strings    ${response.json()['message']['message']}    操作成功
    Should Be Equal As Strings    ${response.json()['data']['profile']['校验返回的nickname']}    希洛莉

手机号码正确，密码错误的情况
    [Tags]    smoke
    ${password}    set variable    10000000
    ${response}=    手机号码登录    &{user}[user2]    ${password}
    log    ${response.content}
    #开始断言接口返回响应
    Should Be Equal As Strings    ${response.status_code}    200
    #开始断言返回结果
    log    ${response.json()['message']['message']}
    Should Be Equal As Strings    ${response.json()['status']}    error
    Should Be Equal As Strings    ${response.json()['message']['message']}    请求验证不通过,权限不足

手机号码不存在
    [Tags]    smoke
    ${user}    set variable    15699999999
    ${password}    set variable    123456
    ${response}=    手机号码登录    ${user}    ${password}
    log    ${response.content}
    #开始断言接口返回响应
    Should Be Equal As Strings    ${response.status_code}    200
    #开始断言返回结果
    log    ${response.json()['message']['message']}
    Should Be Equal As Strings    ${response.json()['status']}    error
    Should Be Equal As Strings    ${response.json()['message']['message']}    请求验证不通过,权限不足
